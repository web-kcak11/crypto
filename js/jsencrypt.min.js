function _typeof(e){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}/*! For license information please see jsencrypt.min.js.LICENSE.txt */!function(n,t){"object"==("undefined"==typeof exports?"undefined":_typeof(exports))&&"object"==("undefined"==typeof module?"undefined":_typeof(module))?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==("undefined"==typeof exports?"undefined":_typeof(exports))?exports.JSEncrypt=t():n.JSEncrypt=t()}(window,function(){return function(){"use strict";var n=[,function(y,t,e){var f=Math.pow,b=String.fromCharCode,ee=Math.floor;function te(e){return"0123456789abcdefghijklmnopqrstuvwxyz".charAt(e)}function r(n,t){return n&t}function ne(n,t){return n|t}function n(n,t){return n^t}function o(n,t){return n&~t}function s(n){if(0==n)return-1;var r=0;return 0==(65535&n)&&(n>>=16,r+=16),0==(255&n)&&(n>>=8,r+=8),0==(15&n)&&(n>>=4,r+=4),0==(3&n)&&(n>>=2,r+=2),0==(1&n)&&++r,r}function a(n){for(var r=0;0!=n;)n&=n-1,++r;return r}function u(n){var t,o,s="";for(t=0;t+3<=n.length;t+=3)o=parseInt(n.substring(t,t+3),16),s+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(o>>6)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(63&o);for(t+1==n.length?(o=parseInt(n.substring(t,t+1),16),s+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(o<<2)):t+2==n.length&&(o=parseInt(n.substring(t,t+2),16),s+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(o>>2)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt((3&o)<<4));0<(3&s.length);)s+="=";return s}function l(r){var t,a="",p=0,d=0;for(t=0;t<r.length&&"="!=r.charAt(t);++t){var g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(r.charAt(t));0>g||(0==p?(a+=te(g>>2),d=3&g,p=1):1==p?(a+=te(d<<2|g>>4),d=15&g,p=2):2==p?(a+=te(d),a+=te(g>>2),d=3&g,p=3):(a+=te(d<<2|g>>4),a+=te(15&g),p=0))}return 1==p&&(a+=te(d<<2)),a}function p(n,r){return n.length>r&&(n=n.substring(0,r)+"\u2026"),n}function T(){return new R(null)}function N(n,t){return new R(n,t)}function P(n,t){var e=se[n.charCodeAt(t)];return null==e?-1:e}function H(n){var t=T();return t.fromInt(n),t}function C(n){var r,o=1;return 0!=(r=n>>>16)&&(n=r,o+=16),0!=(r=n>>8)&&(n=r,o+=8),0!=(r=n>>4)&&(n=r,o+=4),0!=(r=n>>2)&&(n=r,o+=2),0!=(r=n>>1)&&(n=r,o+=1),o}function i(){if(null==L){for(L=new ae;256>ie;){var e=ee(65536*Math.random());k[ie++]=255&e}for(L.init(k),ie=0;ie<k.length;++ie)k[ie]=0;ie=0}return L.next()}e.d(t,{default:function(){return he}});var F,h,Y,re={decode:function(i){var t;if(void 0===h){for(h=Object.create(null),t=0;64>t;++t)h["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(t)]=t;for(h["-"]=62,h._=63,t=0;t<"= \f\n\r\t\xA0\u2028\u2029".length;++t)h["= \f\n\r\t\xA0\u2028\u2029".charAt(t)]=-1}var a=[],r=0,p=0;for(t=0;t<i.length;++t){var d=i.charAt(t);if("="==d)break;if(-1!=(d=h[d])){if(void 0===d)throw new Error("Illegal character at offset "+t);r|=d,4<=++p?(a[a.length]=r>>16,a[a.length]=255&r>>8,a[a.length]=255&r,r=0,p=0):r<<=6}}switch(p){case 1:throw new Error("Base64 encoding incomplete: at least 2 bits missing");case 2:a[a.length]=r>>10;break;case 3:a[a.length]=r>>16,a[a.length]=255&r>>8;}return a},re:/-----BEGIN [^-]+-----([A-Za-z0-9+\/=\s]+)-----END [^-]+-----|begin-base64[^\n]+\n([A-Za-z0-9+\/=\s]+)====/,unarmor:function(n){var r=re.re.exec(n);if(r)if(r[1])n=r[1];else{if(!r[2])throw new Error("RegExp out of sync");n=r[2]}return re.decode(n)}},d=1e13,v=function(){function e(e){this.buf=[+e||0]}return e.prototype.mulAdd=function(o,t){var a,p,g=this.buf,n=g.length;for(a=0;a<n;++a)(p=g[a]*o+t)<d?t=0:p-=(t=0|p/d)*d,g[a]=p;0<t&&(g[a]=t)},e.prototype.sub=function(o){var s,a,p=this.buf,r=p.length;for(s=0;s<r;++s)0>(a=p[s]-o)?(a+=d,o=1):o=0,p[s]=a;for(;0===p[p.length-1];)p.pop()},e.prototype.toString=function(n){if(10!=(n||10))throw new Error("only base 10 is supported");for(var t=this.buf,e=t[t.length-1].toString(),o=t.length-2;0<=o;--o)e+=(d+t[o]).toString().substring(1);return e},e.prototype.valueOf=function(){for(var n=this.buf,t=0,r=n.length-1;0<=r;--r)t=t*d+n[r];return t},e.prototype.simplify=function(){var e=this.buf;return 1==e.length?e[0]:this},e}(),m=function(){function n(t,e){this.hexDigits="0123456789ABCDEF",t instanceof n?(this.enc=t.enc,this.pos=t.pos):(this.enc=t,this.pos=e)}return n.prototype.get=function(e){if(void 0===e&&(e=this.pos++),e>=this.enc.length)throw new Error("Requesting byte offset "+e+" on a stream of length "+this.enc.length);return"string"==typeof this.enc?this.enc.charCodeAt(e):this.enc[e]},n.prototype.hexByte=function(e){return this.hexDigits.charAt(15&e>>4)+this.hexDigits.charAt(15&e)},n.prototype.hexDump=function(o,t,e){for(var s="",i=o;i<t;++i)if(s+=this.hexByte(this.get(i)),!0!==e)switch(15&i){case 7:s+="  ";break;case 15:s+="\n";break;default:s+=" ";}return s},n.prototype.isASCII=function(n,t){for(var e,o=n;o<t;++o)if(e=this.get(o),32>e||176<e)return!1;return!0},n.prototype.parseStringISO=function(n,t){for(var e="",o=n;o<t;++o)e+=b(this.get(o));return e},n.prototype.parseStringUTF=function(o,t){for(var e,s="",a=o;a<t;)e=this.get(a++),s+=128>e?b(e):191<e&&224>e?b((31&e)<<6|63&this.get(a++)):b((15&e)<<12|(63&this.get(a++))<<6|63&this.get(a++));return s},n.prototype.parseStringBMP=function(o,t){for(var e,a,p="",d=o;d<t;)e=this.get(d++),a=this.get(d++),p+=b(e<<8|a);return p},n.prototype.parseTime=function(o,t,e){var s=this.parseStringISO(o,t),i=(e?/^(\d\d)(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])([01]\d|2[0-3])(?:([0-5]\d)(?:([0-5]\d)(?:[.,](\d{1,3}))?)?)?(Z|[-+](?:[0]\d|1[0-2])([0-5]\d)?)?$/:/^(\d\d\d\d)(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])([01]\d|2[0-3])(?:([0-5]\d)(?:([0-5]\d)(?:[.,](\d{1,3}))?)?)?(Z|[-+](?:[0]\d|1[0-2])([0-5]\d)?)?$/).exec(s);return i?(e&&(i[1]=+i[1],i[1]+=70>+i[1]?2e3:1900),s=i[1]+"-"+i[2]+"-"+i[3]+" "+i[4],i[5]&&(s+=":"+i[5],i[6]&&(s+=":"+i[6],i[7]&&(s+="."+i[7]))),i[8]&&(s+=" UTC","Z"!=i[8]&&(s+=i[8],i[9]&&(s+=":"+i[9]))),s):"Unrecognized time: "+s},n.prototype.parseInteger=function(p,d){for(var e,g=this.get(p),l=127<g,n=l?255:0,s="";g==n&&++p<d;)g=this.get(p);if(0==(e=d-p))return l?-1:0;if(4<e){for(s=g,e<<=3;0==(128&(+s^n));)s=+s<<1,--e;s="("+e+" bit)\n"}l&&(g-=256);for(var u=new v(g),c=p+1;c<d;++c)u.mulAdd(256,this.get(c));return s+u.toString()},n.prototype.parseBitString=function(d,t,e){for(var i=this.get(d),r="("+((t-d-1<<3)-i)+" bit)\n",n="",g=d+1;g<t;++g){for(var l=this.get(g),c=g==t-1?i:0,a=7;a>=c;--a)n+=1&l>>a?"1":"0";if(n.length>e)return r+p(n,e)}return r+n},n.prototype.parseOctetString=function(o,t,a){if(this.isASCII(o,t))return p(this.parseStringISO(o,t),a);var d=t-o,r="("+d+" byte)\n";d>(a/=2)&&(t=o+a);for(var g=o;g<t;++g)r+=this.hexByte(this.get(g));return d>a&&(r+="\u2026"),r},n.prototype.parseOID=function(d,t,e){for(var i,g="",l=new v,u=0,c=d;c<t;++c)if(i=this.get(c),l.mulAdd(128,127&i),u+=7,!(128&i)){if(""!==g)g+="."+l.toString();else if((l=l.simplify())instanceof v)l.sub(80),g="2."+l.toString();else{var m=80>l?40>l?0:1:2;g=m+"."+(l-40*m)}if(g.length>e)return p(g,e);l=new v,u=0}return 0<u&&(g+=".incomplete"),g},n}(),E=function(){var n=Math.abs;function d(o,t,e,s,r){if(!(s instanceof w))throw new Error("Invalid tag value.");this.stream=o,this.header=t,this.length=e,this.tag=s,this.sub=r}return d.prototype.typeName=function(){switch(this.tag.tagClass){case 0:switch(this.tag.tagNumber){case 0:return"EOC";case 1:return"BOOLEAN";case 2:return"INTEGER";case 3:return"BIT_STRING";case 4:return"OCTET_STRING";case 5:return"NULL";case 6:return"OBJECT_IDENTIFIER";case 7:return"ObjectDescriptor";case 8:return"EXTERNAL";case 9:return"REAL";case 10:return"ENUMERATED";case 11:return"EMBEDDED_PDV";case 12:return"UTF8String";case 16:return"SEQUENCE";case 17:return"SET";case 18:return"NumericString";case 19:return"PrintableString";case 20:return"TeletexString";case 21:return"VideotexString";case 22:return"IA5String";case 23:return"UTCTime";case 24:return"GeneralizedTime";case 25:return"GraphicString";case 26:return"VisibleString";case 27:return"GeneralString";case 28:return"UniversalString";case 30:return"BMPString";}return"Universal_"+this.tag.tagNumber.toString();case 1:return"Application_"+this.tag.tagNumber.toString();case 2:return"["+this.tag.tagNumber.toString()+"]";case 3:return"Private_"+this.tag.tagNumber.toString();}},d.prototype.content=function(r){if(void 0===this.tag)return null;void 0===r&&(r=1/0);var o=this.posContent(),e=n(this.length);if(!this.tag.isUniversal())return null===this.sub?this.stream.parseOctetString(o,o+e,r):"("+this.sub.length+" elem)";switch(this.tag.tagNumber){case 1:return 0===this.stream.get(o)?"false":"true";case 2:return this.stream.parseInteger(o,o+e);case 3:return this.sub?"("+this.sub.length+" elem)":this.stream.parseBitString(o,o+e,r);case 4:return this.sub?"("+this.sub.length+" elem)":this.stream.parseOctetString(o,o+e,r);case 6:return this.stream.parseOID(o,o+e,r);case 16:case 17:return null===this.sub?"(no elem)":"("+this.sub.length+" elem)";case 12:return p(this.stream.parseStringUTF(o,o+e),r);case 18:case 19:case 20:case 21:case 22:case 26:return p(this.stream.parseStringISO(o,o+e),r);case 30:return p(this.stream.parseStringBMP(o,o+e),r);case 23:case 24:return this.stream.parseTime(o,o+e,23==this.tag.tagNumber);}return null},d.prototype.toString=function(){return this.typeName()+"@"+this.stream.pos+"[header:"+this.header+",length:"+this.length+",sub:"+(null===this.sub?"null":this.sub.length)+"]"},d.prototype.toPrettyString=function(n){void 0===n&&(n="");var o=n+this.typeName()+" @"+this.stream.pos;if(0<=this.length&&(o+="+"),o+=this.length,this.tag.tagConstructed?o+=" (constructed)":!this.tag.isUniversal()||3!=this.tag.tagNumber&&4!=this.tag.tagNumber||null===this.sub||(o+=" (encapsulates)"),o+="\n",null!==this.sub){n+="  ";for(var s=0,a=this.sub.length;s<a;++s)o+=this.sub[s].toPrettyString(n)}return o},d.prototype.posStart=function(){return this.stream.pos},d.prototype.posContent=function(){return this.stream.pos+this.header},d.prototype.posEnd=function(){return this.stream.pos+this.header+n(this.length)},d.prototype.toHexString=function(){return this.stream.hexDump(this.posStart(),this.posEnd(),!0)},d.decodeLength=function(n){var t=n.get(),o=127&t;if(o==t)return o;if(6<o)throw new Error("Length over 48 bits not supported at position "+(n.pos-1));if(0==o)return null;t=0;for(var s=0;s<o;++s)t=256*t+n.get();return t},d.prototype.getHexStringValue=function(){var n=this.toHexString(),t=2*this.header,e=2*this.length;return n.substr(t,e)},d.decode=function(t){var p=t instanceof m?t:new m(t,0);var e=new m(p),r=new w(p),i=d.decodeLength(p),g=p.pos,o=g-e.pos,l=null,h=function(){var t=[];if(null!==i){for(var e=g+i;p.pos<e;)t[t.length]=d.decode(p);if(p.pos!=e)throw new Error("Content size is not correct for container starting at offset "+g)}else try{for(;;){var r=d.decode(p);if(r.tag.isEOC())break;t[t.length]=r}i=g-p.pos}catch(e){throw new Error("Exception while decoding undefined length content: "+e)}return t};if(r.tagConstructed)l=h();else if(r.isUniversal()&&(3==r.tagNumber||4==r.tagNumber))try{if(3==r.tagNumber&&0!=p.get())throw new Error("BIT STRINGs with unused bits cannot encapsulate.");l=h();for(var u=0;u<l.length;++u)if(l[u].tag.isEOC())throw new Error("EOC is not supposed to be actual content.")}catch(e){l=null}if(null===l){if(null===i)throw new Error("We can't skip over an invalid tag with undefined length at offset "+g);p.pos=g+n(i)}return new d(e,o,i,r,l)},d}(),w=function(){function e(n){var t=n.get();if(this.tagClass=t>>6,this.tagConstructed=0!=(32&t),this.tagNumber=31&t,31==this.tagNumber){var r=new v;do t=n.get(),r.mulAdd(128,127&t);while(128&t);this.tagNumber=r.simplify()}}return e.prototype.isUniversal=function(){return 0===this.tagClass},e.prototype.isEOC=function(){return 0===this.tagClass&&0===this.tagNumber},e}(),D=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],x=67108864/D[D.length-1],R=function(){var p=Math.min,d=Math.max;function S(n,t,e){null!=n&&("number"==typeof n?this.fromNumber(n,t,e):null==t&&"string"!=typeof n?this.fromString(n,256):this.fromString(n,t))}return S.prototype.toString=function(r){if(0>this.s)return"-"+this.negate().toString(r);var t;if(16==r)t=4;else if(8==r)t=3;else if(2==r)t=1;else if(32==r)t=5;else{if(4!=r)return this.toRadix(r);t=2}var p,d=(1<<t)-1,n=!1,g="",l=this.t,u=this.DB-l*this.DB%t;if(0<l--)for(u<this.DB&&0<(p=this[l]>>u)&&(n=!0,g=te(p));0<=l;)u<t?(p=(this[l]&(1<<u)-1)<<t-u,p|=this[--l]>>(u+=this.DB-t)):(p=this[l]>>(u-=t)&d,0>=u&&(u+=this.DB,--l)),0<p&&(n=!0),n&&(g+=te(p));return n?g:"0"},S.prototype.negate=function(){var t=T();return S.ZERO.subTo(this,t),t},S.prototype.abs=function(){return 0>this.s?this.negate():this},S.prototype.compareTo=function(n){var t=this.s-n.s;if(0!=t)return t;var r=this.t;if(0!=(t=r-n.t))return 0>this.s?-t:t;for(;0<=--r;)if(0!=(t=this[r]-n[r]))return t;return 0},S.prototype.bitLength=function(){return 0>=this.t?0:this.DB*(this.t-1)+C(this[this.t-1]^this.s&this.DM)},S.prototype.mod=function(t){var e=T();return this.abs().divRemTo(t,null,e),0>this.s&&0<e.compareTo(S.ZERO)&&t.subTo(e,e),e},S.prototype.modPowInt=function(n,t){var e;return e=256>n||t.isEven()?new O(t):new A(t),this.exp(n,e)},S.prototype.clone=function(){var e=T();return this.copyTo(e),e},S.prototype.intValue=function(){if(0>this.s){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]},S.prototype.byteValue=function(){return 0==this.t?this.s:this[0]<<24>>24},S.prototype.shortValue=function(){return 0==this.t?this.s:this[0]<<16>>16},S.prototype.signum=function(){return 0>this.s?-1:0>=this.t||1==this.t&&0>=this[0]?0:1},S.prototype.toByteArray=function(){var o=this.t,s=[];s[0]=this.s;var e,a=this.DB-o*this.DB%8,p=0;if(0<o--)for(a<this.DB&&(e=this[o]>>a)!=(this.s&this.DM)>>a&&(s[p++]=e|this.s<<this.DB-a);0<=o;)8>a?(e=(this[o]&(1<<a)-1)<<8-a,e|=this[--o]>>(a+=this.DB-8)):(e=255&this[o]>>(a-=8),0>=a&&(a+=this.DB,--o)),0!=(128&e)&&(e|=-256),0==p&&(128&this.s)!=(128&e)&&++p,(0<p||e!=this.s)&&(s[p++]=e);return s},S.prototype.equals=function(e){return 0==this.compareTo(e)},S.prototype.min=function(e){return 0>this.compareTo(e)?this:e},S.prototype.max=function(e){return 0<this.compareTo(e)?this:e},S.prototype.and=function(n){var t=T();return this.bitwiseTo(n,r,t),t},S.prototype.or=function(n){var t=T();return this.bitwiseTo(n,ne,t),t},S.prototype.xor=function(r){var t=T();return this.bitwiseTo(r,n,t),t},S.prototype.andNot=function(n){var t=T();return this.bitwiseTo(n,o,t),t},S.prototype.not=function(){for(var n=T(),t=0;t<this.t;++t)n[t]=this.DM&~this[t];return n.t=this.t,n.s=~this.s,n},S.prototype.shiftLeft=function(n){var t=T();return 0>n?this.rShiftTo(-n,t):this.lShiftTo(n,t),t},S.prototype.shiftRight=function(n){var t=T();return 0>n?this.lShiftTo(-n,t):this.rShiftTo(n,t),t},S.prototype.getLowestSetBit=function(){for(var e=0;e<this.t;++e)if(0!=this[e])return e*this.DB+s(this[e]);return 0>this.s?this.t*this.DB:-1},S.prototype.bitCount=function(){for(var n=0,r=this.s&this.DM,e=0;e<this.t;++e)n+=a(this[e]^r);return n},S.prototype.testBit=function(n){var t=ee(n/this.DB);return t>=this.t?0!=this.s:0!=(this[t]&1<<n%this.DB)},S.prototype.setBit=function(e){return this.changeBit(e,ne)},S.prototype.clearBit=function(e){return this.changeBit(e,o)},S.prototype.flipBit=function(e){return this.changeBit(e,n)},S.prototype.add=function(n){var t=T();return this.addTo(n,t),t},S.prototype.subtract=function(n){var t=T();return this.subTo(n,t),t},S.prototype.multiply=function(n){var t=T();return this.multiplyTo(n,t),t},S.prototype.divide=function(n){var t=T();return this.divRemTo(n,t,null),t},S.prototype.remainder=function(n){var t=T();return this.divRemTo(n,null,t),t},S.prototype.divideAndRemainder=function(n){var t=T(),e=T();return this.divRemTo(n,t,e),[t,e]},S.prototype.modPow=function(m,t){var e,y,b=m.bitLength(),S=H(1);if(0>=b)return S;e=18>b?1:48>b?3:144>b?4:768>b?5:6,y=8>b?new O(t):t.isEven()?new V(t):new A(t);var E=[],o=3,D=e-1,a=(1<<e)-1;if(E[1]=y.convert(this),1<e){var u=T();for(y.sqrTo(E[1],u);o<=a;)E[o]=T(),y.mulTo(u,E[o-2],E[o]),o+=2}var c,x,R=m.t-1,B=!0,N=T();for(b=C(m[R])-1;0<=R;){for(b>=D?c=m[R]>>b-D&a:(c=(m[R]&(1<<b+1)-1)<<D-b,0<R&&(c|=m[R-1]>>this.DB+b-D)),o=e;0==(1&c);)c>>=1,--o;if(0>(b-=o)&&(b+=this.DB,--R),B)E[c].copyTo(S),B=!1;else{for(;1<o;)y.sqrTo(S,N),y.sqrTo(N,S),o-=2;0<o?y.sqrTo(S,N):(x=S,S=N,N=x),y.mulTo(N,E[c],S)}for(;0<=R&&0==(m[R]&1<<b);)y.sqrTo(S,N),x=S,S=N,N=x,0>--b&&(b=this.DB-1,--R)}return y.revert(S)},S.prototype.modInverse=function(t){var e=t.isEven();if(this.isEven()&&e||0==t.signum())return S.ZERO;for(var i=t.clone(),r=this.clone(),n=H(1),s=H(0),o=H(0),p=H(1);0!=i.signum();){for(;i.isEven();)i.rShiftTo(1,i),e?(n.isEven()&&s.isEven()||(n.addTo(this,n),s.subTo(t,s)),n.rShiftTo(1,n)):s.isEven()||s.subTo(t,s),s.rShiftTo(1,s);for(;r.isEven();)r.rShiftTo(1,r),e?(o.isEven()&&p.isEven()||(o.addTo(this,o),p.subTo(t,p)),o.rShiftTo(1,o)):p.isEven()||p.subTo(t,p),p.rShiftTo(1,p);0<=i.compareTo(r)?(i.subTo(r,i),e&&n.subTo(o,n),s.subTo(p,s)):(r.subTo(i,r),e&&o.subTo(n,o),p.subTo(s,p))}return 0==r.compareTo(S.ONE)?0<=p.compareTo(t)?p.subtract(t):0>p.signum()?(p.addTo(t,p),0>p.signum()?p.add(t):p):p:S.ZERO},S.prototype.pow=function(e){return this.exp(e,new B)},S.prototype.gcd=function(o){var t=0>this.s?this.negate():this.clone(),a=0>o.s?o.negate():o.clone();if(0>t.compareTo(a)){var p=t;t=a,a=p}var r=t.getLowestSetBit(),d=a.getLowestSetBit();if(0>d)return t;for(r<d&&(d=r),0<d&&(t.rShiftTo(d,t),a.rShiftTo(d,a));0<t.signum();)0<(r=t.getLowestSetBit())&&t.rShiftTo(r,t),0<(r=a.getLowestSetBit())&&a.rShiftTo(r,a),0<=t.compareTo(a)?(t.subTo(a,t),t.rShiftTo(1,t)):(a.subTo(t,a),a.rShiftTo(1,a));return 0<d&&a.lShiftTo(d,a),a},S.prototype.isProbablePrime=function(o){var t,s=this.abs();if(1==s.t&&s[0]<=D[D.length-1]){for(t=0;t<D.length;++t)if(s[0]==D[t])return!0;return!1}if(s.isEven())return!1;for(t=1;t<D.length;){for(var i=D[t],a=t+1;a<D.length&&i<x;)i*=D[a++];for(i=s.modInt(i);t<a;)if(0==i%D[t++])return!1}return s.millerRabin(o)},S.prototype.copyTo=function(n){for(var t=this.t-1;0<=t;--t)n[t]=this[t];n.t=this.t,n.s=this.s},S.prototype.fromInt=function(e){this.t=1,this.s=0>e?-1:0,0<e?this[0]=e:-1>e?this[0]=e+this.DV:this.t=0},S.prototype.fromString=function(t,e){var i;if(16==e)i=4;else if(8==e)i=3;else if(256==e)i=8;else if(2==e)i=1;else if(32==e)i=5;else{if(4!=e)return void this.fromRadix(t,e);i=2}this.t=0,this.s=0;for(var a,p=t.length,d=!1,g=0;0<=--p;)a=8==i?255&+t[p]:P(t,p),0>a?"-"==t.charAt(p)&&(d=!0):(d=!1,0==g?this[this.t++]=a:g+i>this.DB?(this[this.t-1]|=(a&(1<<this.DB-g)-1)<<g,this[this.t++]=a>>this.DB-g):this[this.t-1]|=a<<g,(g+=i)>=this.DB&&(g-=this.DB));8==i&&0!=(128&+t[0])&&(this.s=-1,0<g&&(this[this.t-1]|=(1<<this.DB-g)-1<<g)),this.clamp(),d&&S.ZERO.subTo(this,this)},S.prototype.clamp=function(){for(var e=this.s&this.DM;0<this.t&&this[this.t-1]==e;)--this.t},S.prototype.dlShiftTo=function(n,t){var e;for(e=this.t-1;0<=e;--e)t[e+n]=this[e];for(e=n-1;0<=e;--e)t[e]=0;t.t=this.t+n,t.s=this.s},S.prototype.drShiftTo=function(n,t){for(var e=n;e<this.t;++e)t[e-n]=this[e];t.t=d(this.t-n,0),t.s=this.s},S.prototype.lShiftTo=function(n,t){for(var e=n%this.DB,i=this.DB-e,r=ee(n/this.DB),s=this.s<<e&this.DM,a=this.t-1;0<=a;--a)t[a+r+1]=this[a]>>i|s,s=(this[a]&(1<<i)-1)<<e;for(a=r-1;0<=a;--a)t[a]=0;t[r]=s,t.t=this.t+r+1,t.s=this.s,t.clamp()},S.prototype.rShiftTo=function(a,t){t.s=this.s;var e=ee(a/this.DB);if(e>=this.t)t.t=0;else{var i=a%this.DB,r=this.DB-i,n=(1<<i)-1;t[0]=this[e]>>i;for(var s=e+1;s<this.t;++s)t[s-e-1]|=(this[s]&n)<<r,t[s-e]=this[s]>>i;0<i&&(t[this.t-e-1]|=(this.s&n)<<r),t.t=this.t-e,t.clamp()}},S.prototype.subTo=function(o,t){for(var e=0,s=0,a=p(o.t,this.t);e<a;)s+=this[e]-o[e],t[e++]=s&this.DM,s>>=this.DB;if(o.t<this.t){for(s-=o.s;e<this.t;)s+=this[e],t[e++]=s&this.DM,s>>=this.DB;s+=this.s}else{for(s+=this.s;e<o.t;)s-=o[e],t[e++]=s&this.DM,s>>=this.DB;s-=o.s}t.s=0>s?-1:0,-1>s?t[e++]=this.DV+s:0<s&&(t[e++]=s),t.t=e,t.clamp()},S.prototype.multiplyTo=function(t,e){var o=this.abs(),r=t.abs(),n=o.t;for(e.t=n+r.t;0<=--n;)e[n]=0;for(n=0;n<r.t;++n)e[n+o.t]=o.am(0,r[n],e,n,0,o.t);e.s=0,e.clamp(),this.s!=t.s&&S.ZERO.subTo(e,e)},S.prototype.squareTo=function(n){for(var t=this.abs(),e=n.t=2*t.t;0<=--e;)n[e]=0;for(e=0;e<t.t-1;++e){var o=t.am(e,t[e],n,2*e,0,1);(n[e+t.t]+=t.am(e+1,2*t[e],n,2*e+1,o,t.t-e-1))>=t.DV&&(n[e+t.t]-=t.DV,n[e+t.t+1]=1)}0<n.t&&(n[n.t-1]+=t.am(e,t[e],n,2*e,0,1)),n.s=0,n.clamp()},S.prototype.divRemTo=function(t,e,i){var E=t.abs();if(!(0>=E.t)){var n=this.abs();if(n.t<E.t)return null!=e&&e.fromInt(0),void(null!=i&&this.copyTo(i));null==i&&(i=T());var s=T(),o=this.s,h=t.s,a=this.DB-C(E[E.t-1]);0<a?(E.lShiftTo(a,s),n.lShiftTo(a,i)):(E.copyTo(s),n.copyTo(i));var u=s.t,c=s[u-1];if(0!=c){var f=c*(1<<this.F1)+(1<u?s[u-2]>>this.F2:0),l=this.FV/f,p=(1<<this.F1)/f,g=1<<this.F2,d=i.t,D=d-u,x=null==e?T():e;for(s.dlShiftTo(D,x),0<=i.compareTo(x)&&(i[i.t++]=1,i.subTo(x,i)),S.ONE.dlShiftTo(u,x),x.subTo(s,s);s.t<u;)s[s.t++]=0;for(;0<=--D;){var y=i[--d]==c?this.DM:ee(i[d]*l+(i[d-1]+g)*p);if((i[d]+=s.am(0,y,i,D,0,u))<y)for(s.dlShiftTo(D,x),i.subTo(x,i);i[d]<--y;)i.subTo(x,i)}null!=e&&(i.drShiftTo(u,e),o!=h&&S.ZERO.subTo(e,e)),i.t=u,i.clamp(),0<a&&i.rShiftTo(a,i),0>o&&S.ZERO.subTo(i,i)}}},S.prototype.invDigit=function(){if(1>this.t)return 0;var n=this[0];if(0==(1&n))return 0;var t=3&n;return 0<(t=(t=65535&(t=255&(t=15&t*(2-(15&n)*t))*(2-(255&n)*t))*(2-(65535&(65535&n)*t)))*(2-n*t%this.DV)%this.DV)?this.DV-t:-t},S.prototype.isEven=function(){return 0==(0<this.t?1&this[0]:this.s)},S.prototype.exp=function(t,e){if(4294967295<t||1>t)return S.ONE;var i=T(),a=T(),p=e.convert(this),s=C(t)-1;for(p.copyTo(i);0<=--s;)if(e.sqrTo(i,a),0<(t&1<<s))e.mulTo(a,p,i);else{var d=i;i=a,a=d}return e.revert(i)},S.prototype.chunkSize=function(e){return ee(Math.LN2*this.DB/Math.log(e))},S.prototype.toRadix=function(a){if(null==a&&(a=10),0==this.signum()||2>a||36<a)return"0";var p=this.chunkSize(a),e=f(a,p),i=H(e),r=T(),n=T(),s="";for(this.divRemTo(i,r,n);0<r.signum();)s=(e+n.intValue()).toString(a).substr(1)+s,r.divRemTo(i,r,n);return n.intValue().toString(a)+s},S.prototype.fromRadix=function(t,e){this.fromInt(0),null==e&&(e=10);for(var p,d=this.chunkSize(e),r=f(e,d),n=!1,g=0,l=0,c=0;c<t.length;++c)p=P(t,c),0>p?"-"==t.charAt(c)&&0==this.signum()&&(n=!0):(l=e*l+p,++g>=d&&(this.dMultiply(r),this.dAddOffset(l,0),g=0,l=0));0<g&&(this.dMultiply(f(e,g)),this.dAddOffset(l,0)),n&&S.ZERO.subTo(this,this)},S.prototype.fromNumber=function(t,e,s){if(!("number"==typeof e)){var r=[],n=7&t;r.length=1+(t>>3),e.nextBytes(r),0<n?r[0]&=(1<<n)-1:r[0]=0,this.fromString(r,256)}else if(2>t)this.fromInt(1);else for(this.fromNumber(t,s),this.testBit(t-1)||this.bitwiseTo(S.ONE.shiftLeft(t-1),ne,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(S.ONE.shiftLeft(t-1),this)},S.prototype.bitwiseTo=function(o,t,e){var i,a,d=p(o.t,this.t);for(i=0;i<d;++i)e[i]=t(this[i],o[i]);if(o.t<this.t){for(a=o.s&this.DM,i=d;i<this.t;++i)e[i]=t(this[i],a);e.t=this.t}else{for(a=this.s&this.DM,i=d;i<o.t;++i)e[i]=t(a,o[i]);e.t=o.t}e.s=t(this.s,o.s),e.clamp()},S.prototype.changeBit=function(t,e){var n=S.ONE.shiftLeft(t);return this.bitwiseTo(n,e,n),n},S.prototype.addTo=function(o,t){for(var e=0,s=0,a=p(o.t,this.t);e<a;)s+=this[e]+o[e],t[e++]=s&this.DM,s>>=this.DB;if(o.t<this.t){for(s+=o.s;e<this.t;)s+=this[e],t[e++]=s&this.DM,s>>=this.DB;s+=this.s}else{for(s+=this.s;e<o.t;)s+=o[e],t[e++]=s&this.DM,s>>=this.DB;s+=o.s}t.s=0>s?-1:0,0<s?t[e++]=s:-1>s&&(t[e++]=this.DV+s),t.t=e,t.clamp()},S.prototype.dMultiply=function(e){this[this.t]=this.am(0,e-1,this,0,0,this.t),++this.t,this.clamp()},S.prototype.dAddOffset=function(n,t){if(0!=n){for(;this.t<=t;)this[this.t++]=0;for(this[t]+=n;this[t]>=this.DV;)this[t]-=this.DV,++t>=this.t&&(this[this.t++]=0),++this[t]}},S.prototype.multiplyLowerTo=function(o,t,e){var s=p(this.t+o.t,t);for(e.s=0,e.t=s;0<s;)e[--s]=0;for(var i=e.t-this.t;s<i;++s)e[s+this.t]=this.am(0,o[s],e,s,0,this.t);for(i=p(o.t,t);s<i;++s)this.am(0,o[s],e,s,0,t-s);e.clamp()},S.prototype.multiplyUpperTo=function(n,t,o){--t;var s=o.t=this.t+n.t-t;for(o.s=0;0<=--s;)o[s]=0;for(s=d(t-this.t,0);s<n.t;++s)o[this.t+s-t]=this.am(t-s,n[s],o,0,0,this.t+s-t);o.clamp(),o.drShiftTo(1,o)},S.prototype.modInt=function(n){if(0>=n)return 0;var t=this.DV%n,e=0>this.s?n-1:0;if(0<this.t)if(0==t)e=this[0]%n;else for(var o=this.t-1;0<=o;--o)e=(t*e+this[o])%n;return e},S.prototype.millerRabin=function(t){var p=this.subtract(S.ONE),i=p.getLowestSetBit();if(0>=i)return!1;var r=p.shiftRight(i);(t=t+1>>1)>D.length&&(t=D.length);for(var n=T(),s=0;s<t;++s){n.fromInt(D[ee(Math.random()*D.length)]);var d=n.modPow(r,this);if(0!=d.compareTo(S.ONE)&&0!=d.compareTo(p)){for(var g=1;g++<i&&0!=d.compareTo(p);)if(0==(d=d.modPowInt(2,this)).compareTo(S.ONE))return!1;if(0!=d.compareTo(p))return!1}}return!0},S.prototype.square=function(){var e=T();return this.squareTo(e),e},S.prototype.gcda=function(a,t){var e=0>this.s?this.negate():this.clone(),p=0>a.s?a.negate():a.clone();if(0>e.compareTo(p)){var d=e;e=p,p=d}var n=e.getLowestSetBit(),g=p.getLowestSetBit();if(0>g)t(e);else{n<g&&(g=n),0<g&&(e.rShiftTo(g,e),p.rShiftTo(g,p));var l=function r(){0<(n=e.getLowestSetBit())&&e.rShiftTo(n,e),0<(n=p.getLowestSetBit())&&p.rShiftTo(n,p),0<=e.compareTo(p)?(e.subTo(p,e),e.rShiftTo(1,e)):(p.subTo(e,p),p.rShiftTo(1,p)),0<e.signum()?setTimeout(r,0):(0<g&&p.lShiftTo(g,p),setTimeout(function(){t(p)},0))};setTimeout(l,10)}},S.prototype.fromNumberAsync=function(t,e,s,r){if(!("number"==typeof e)){var n=[],i=7&t;n.length=1+(t>>3),e.nextBytes(n),0<i?n[0]&=(1<<i)-1:n[0]=0,this.fromString(n,256)}else if(2>t)this.fromInt(1);else{this.fromNumber(t,s),this.testBit(t-1)||this.bitwiseTo(S.ONE.shiftLeft(t-1),ne,this),this.isEven()&&this.dAddOffset(1,0);var a=this,o=function n(){a.dAddOffset(2,0),a.bitLength()>t&&a.subTo(S.ONE.shiftLeft(t-1),a),a.isProbablePrime(e)?setTimeout(function(){r()},0):setTimeout(n,0)};setTimeout(o,0)}},S}(),B=function(){function e(){}return e.prototype.convert=function(e){return e},e.prototype.revert=function(e){return e},e.prototype.mulTo=function(n,t,e){n.multiplyTo(t,e)},e.prototype.sqrTo=function(n,t){n.squareTo(t)},e}(),O=function(){function e(e){this.m=e}return e.prototype.convert=function(e){return 0>e.s||0<=e.compareTo(this.m)?e.mod(this.m):e},e.prototype.revert=function(e){return e},e.prototype.reduce=function(e){e.divRemTo(this.m,null,e)},e.prototype.mulTo=function(n,t,e){n.multiplyTo(t,e),this.reduce(e)},e.prototype.sqrTo=function(n,t){n.squareTo(t),this.reduce(t)},e}(),A=function(){function e(e){this.m=e,this.mp=e.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}return e.prototype.convert=function(n){var t=T();return n.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),0>n.s&&0<t.compareTo(R.ZERO)&&this.m.subTo(t,t),t},e.prototype.revert=function(n){var t=T();return n.copyTo(t),this.reduce(t),t},e.prototype.reduce=function(n){for(;n.t<=this.mt2;)n[n.t++]=0;for(var t=0;t<this.m.t;++t){var o=32767&n[t],s=o*this.mpl+((o*this.mph+(n[t]>>15)*this.mpl&this.um)<<15)&n.DM;for(n[o=t+this.m.t]+=this.m.am(0,s,n,t,0,this.m.t);n[o]>=n.DV;)n[o]-=n.DV,n[++o]++}n.clamp(),n.drShiftTo(this.m.t,n),0<=n.compareTo(this.m)&&n.subTo(this.m,n)},e.prototype.mulTo=function(n,t,e){n.multiplyTo(t,e),this.reduce(e)},e.prototype.sqrTo=function(n,t){n.squareTo(t),this.reduce(t)},e}(),V=function(){function e(e){this.m=e,this.r2=T(),this.q3=T(),R.ONE.dlShiftTo(2*e.t,this.r2),this.mu=this.r2.divide(e)}return e.prototype.convert=function(n){if(0>n.s||n.t>2*this.m.t)return n.mod(this.m);if(0>n.compareTo(this.m))return n;var t=T();return n.copyTo(t),this.reduce(t),t},e.prototype.revert=function(e){return e},e.prototype.reduce=function(e){for(e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);0>e.compareTo(this.r2);)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);0<=e.compareTo(this.m);)e.subTo(this.m,e)},e.prototype.mulTo=function(n,t,e){n.multiplyTo(t,e),this.reduce(e)},e.prototype.sqrTo=function(n,t){n.squareTo(t),this.reduce(t)},e}(),I="undefined"!=typeof navigator;I&&"Microsoft Internet Explorer"==navigator.appName?(R.prototype.am=function(p,d,e,i,g,l){for(var m=32767&d,o=d>>15;0<=--l;){var h=32767&this[p],y=this[p++]>>15,u=o*h+y*m;g=((h=m*h+((32767&u)<<15)+e[i]+(1073741823&g))>>>30)+(u>>>15)+o*y+(g>>>30),e[i++]=1073741823&h}return g},Y=30):I&&"Netscape"!=navigator.appName?(R.prototype.am=function(a,p,e,i,d,g){for(;0<=--g;){var l=p*this[a++]+e[i]+d;d=ee(l/67108864),e[i++]=67108863&l}return d},Y=26):(R.prototype.am=function(p,d,e,i,g,l){for(var m=16383&d,o=d>>14;0<=--l;){var h=16383&this[p],y=this[p++]>>14,u=o*h+y*m;g=((h=m*h+((16383&u)<<14)+e[i]+g)>>28)+(u>>14)+o*y,e[i++]=268435455&h}return g},Y=28),R.prototype.DB=Y,R.prototype.DM=(1<<Y)-1,R.prototype.DV=1<<Y,R.prototype.FV=f(2,52),R.prototype.F1=52-Y,R.prototype.F2=2*Y-52;var M,oe,se=[];for(M=48,oe=0;9>=oe;++oe)se[M++]=oe;for(M=97,oe=10;36>oe;++oe)se[M++]=oe;for(M=65,oe=10;36>oe;++oe)se[M++]=oe;R.ZERO=H(0),R.ONE=H(1);var L,ie,ae=function(){function e(){this.i=0,this.j=0,this.S=[]}return e.prototype.init=function(n){var t,o,s;for(t=0;256>t;++t)this.S[t]=t;for(o=0,t=0;256>t;++t)o=255&o+this.S[t]+n[t%n.length],s=this.S[t],this.S[t]=this.S[o],this.S[o]=s;this.i=0,this.j=0},e.prototype.next=function(){var e;return this.i=255&this.i+1,this.j=255&this.j+this.S[this.i],e=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=e,this.S[255&e+this.S[this.i]]},e}(),k=null;if(null==k){k=[],ie=0;var pe;if(window.crypto&&window.crypto.getRandomValues){var de=new Uint32Array(256);for(window.crypto.getRandomValues(de),pe=0;pe<de.length;++pe)k[ie++]=255&de[pe]}var Z=0,ge=function n(r){if(256<=(Z=Z||0)||256<=ie)window.removeEventListener?window.removeEventListener("mousemove",n,!1):window.detachEvent&&window.detachEvent("onmousemove",n);else try{var t=r.x+r.y;k[ie++]=255&t,Z+=1}catch(e){}};window.addEventListener?window.addEventListener("mousemove",ge,!1):window.attachEvent&&window.attachEvent("onmousemove",ge)}var $=function(){function e(){}return e.prototype.nextBytes=function(n){for(var t=0;t<n.length;++t)n[t]=i()},e}(),J=function(){function e(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}return e.prototype.doPublic=function(e){return e.modPowInt(this.e,this.n)},e.prototype.doPrivate=function(n){if(null==this.p||null==this.q)return n.modPow(this.d,this.n);for(var t=n.mod(this.p).modPow(this.dmp1,this.p),r=n.mod(this.q).modPow(this.dmq1,this.q);0>t.compareTo(r);)t=t.add(this.p);return t.subtract(r).multiply(this.coeff).mod(this.p).multiply(this.q).add(r)},e.prototype.setPublic=function(n,t){null!=n&&null!=t&&0<n.length&&0<t.length?(this.n=N(n,16),this.e=parseInt(t,16)):console.error("Invalid RSA public key")},e.prototype.encrypt=function(a){var t=this.n.bitLength()+7>>3,e=function(a,t){if(t<a.length+11)return console.error("Message too long for RSA"),null;for(var p,d=[],i=a.length-1;0<=i&&0<t;)p=a.charCodeAt(i--),128>p?d[--t]=p:127<p&&2048>p?(d[--t]=128|63&p,d[--t]=192|p>>6):(d[--t]=128|63&p,d[--t]=128|63&p>>6,d[--t]=224|p>>12);d[--t]=0;for(var g=new $,s=[];2<t;){for(s[0]=0;0==s[0];)g.nextBytes(s);d[--t]=s[0]}return d[--t]=2,d[--t]=0,new R(d)}(a,t);if(null==e)return null;var i=this.doPublic(e);if(null==i)return null;for(var r=i.toString(16),p=r.length,s=0;s<2*t-p;s++)r="0"+r;return r},e.prototype.setPrivate=function(n,t,e){null!=n&&null!=t&&0<n.length&&0<t.length?(this.n=N(n,16),this.e=parseInt(t,16),this.d=N(e,16)):console.error("Invalid RSA private key")},e.prototype.setPrivateEx=function(a,t,e,i,r,n,s,o){null!=a&&null!=t&&0<a.length&&0<t.length?(this.n=N(a,16),this.e=parseInt(t,16),this.d=N(e,16),this.p=N(i,16),this.q=N(r,16),this.dmp1=N(n,16),this.dmq1=N(s,16),this.coeff=N(o,16)):console.error("Invalid RSA private key")},e.prototype.generate=function(p,t){var e=new $,i=p>>1;this.e=parseInt(t,16);for(var r=new R(t,16);;){for(;this.p=new R(p-i,1,e),0!=this.p.subtract(R.ONE).gcd(r).compareTo(R.ONE)||!this.p.isProbablePrime(10););for(;this.q=new R(i,1,e),0!=this.q.subtract(R.ONE).gcd(r).compareTo(R.ONE)||!this.q.isProbablePrime(10););if(0>=this.p.compareTo(this.q)){var n=this.p;this.p=this.q,this.q=n}var s=this.p.subtract(R.ONE),o=this.q.subtract(R.ONE),d=s.multiply(o);if(0==d.gcd(r).compareTo(R.ONE)){this.n=this.p.multiply(this.q),this.d=r.modInverse(d),this.dmp1=this.d.mod(s),this.dmq1=this.d.mod(o),this.coeff=this.q.modInverse(this.p);break}}},e.prototype.decrypt=function(n){var t=N(n,16),e=this.doPrivate(t);return null==e?null:function(o,t){for(var e=o.toByteArray(),i=0;i<e.length&&0==e[i];)++i;if(e.length-i!=t-1||2!=e[i])return null;for(++i;0!=e[i];)if(++i>=e.length)return null;for(var a,p="";++i<e.length;)a=255&e[i],128>a?p+=b(a):191<a&&224>a?(p+=b((31&a)<<6|63&e[i+1]),++i):(p+=b((15&a)<<12|(63&e[i+1])<<6|63&e[i+2]),i+=2);return p}(e,this.n.bitLength()+7>>3)},e.prototype.generateAsync=function(p,t,e){var i=new $,r=p>>1;this.e=parseInt(t,16);var d=new R(t,16),s=this;setTimeout(function o(){var n=function i(){if(0>=s.p.compareTo(s.q)){var a=s.p;s.p=s.q,s.q=a}var i=s.p.subtract(R.ONE),t=s.q.subtract(R.ONE),r=i.multiply(t);0==r.gcd(d).compareTo(R.ONE)?(s.n=s.p.multiply(s.q),s.d=d.modInverse(r),s.dmp1=s.d.mod(i),s.dmq1=s.d.mod(t),s.coeff=s.q.modInverse(s.p),setTimeout(function(){e()},0)):setTimeout(o,0)},g=function e(){s.q=T(),s.q.fromNumberAsync(r,1,i,function(){s.q.subtract(R.ONE).gcda(d,function(r){0==r.compareTo(R.ONE)&&s.q.isProbablePrime(10)?setTimeout(n,0):setTimeout(e,0)})})};setTimeout(function e(){s.p=T(),s.p.fromNumberAsync(p-r,1,i,function(){s.p.subtract(R.ONE).gcda(d,function(n){0==n.compareTo(R.ONE)&&s.p.isProbablePrime(10)?setTimeout(g,0):setTimeout(e,0)})})},0)},0)},e.prototype.sign=function(o,t,e){var i=function(o,t){if(t<o.length+22)return console.error("Message too long for RSA"),null;for(var e=t-o.length-6,s="",i=0;i<e;i+=2)s+="ff";return N("0001"+s+"00"+o,16)}((X[e]||"")+t(o).toString(),this.n.bitLength()/4);if(null==i)return null;var r=this.doPrivate(i);if(null==r)return null;var n=r.toString(16);return 0==(1&n.length)?n:"0"+n},e.prototype.verify=function(o,t,e){var s=N(t,16),r=this.doPublic(s);return null==r?null:function(n){for(var t in X)if(X.hasOwnProperty(t)){var e=X[t],o=e.length;if(n.substr(0,o)==e)return n.substr(o)}return n}(r.toString(16).replace(/^1f+00/,""))==e(o).toString()},e}(),X={md2:"3020300c06082a864886f70d020205000410",md5:"3020300c06082a864886f70d020505000410",sha1:"3021300906052b0e03021a05000414",sha224:"302d300d06096086480165030402040500041c",sha256:"3031300d060960864801650304020105000420",sha384:"3041300d060960864801650304020205000430",sha512:"3051300d060960864801650304020305000440",ripemd160:"3021300906052b2403020105000414"},Q={};Q.lang={extend:function(a,t,e){if(!t||!a)throw new Error("YAHOO.lang.extend failed, please check that all dependencies are included.");var i=function(){};if(i.prototype=t.prototype,a.prototype=new i,a.prototype.constructor=a,a.superclass=t.prototype,t.prototype.constructor==Object.prototype.constructor&&(t.prototype.constructor=t),e){for(var p in e)a.prototype[p]=e[p];var r=function(){},d=["toString","valueOf"];try{/MSIE/.test(navigator.userAgent)&&(r=function(n,t){for(p=0;p<d.length;p+=1){var e=d[p],o=t[e];"function"==typeof o&&o!=Object.prototype[e]&&(n[e]=o)}})}catch(e){}r(a.prototype,e)}}};var W={};void 0!==W.asn1&&W.asn1||(W.asn1={}),W.asn1.ASN1Util=new function(){this.integerToByteHex=function(n){var t=n.toString(16);return 1==t.length%2&&(t="0"+t),t},this.bigIntToMinTwosComplementsHex=function(o){var t=o.toString(16);if("-"!=t.substr(0,1))1==t.length%2?t="0"+t:t.match(/^[0-7]/)||(t="00"+t);else{var s=t.substr(1).length;1==s%2?s+=1:t.match(/^[0-7]/)||(s+=2);for(var a="",p=0;p<s;p++)a+="f";t=new R(a,16).xor(o).add(R.ONE).toString(16).replace(/^-/,"")}return t},this.getPEMStringFromHex=function(n,t){return hextopem(n,t)},this.newObject=function(V){var t=W.asn1,e=t.DERBoolean,i=t.DERInteger,r=t.DERBitString,n=t.DEROctetString,s=t.DERNull,o=t.DERObjectIdentifier,h=t.DEREnumerated,a=t.DERUTF8String,u=t.DERNumericString,c=t.DERPrintableString,f=t.DERTeletexString,l=t.DERIA5String,p=t.DERUTCTime,g=t.DERGeneralizedTime,d=t.DERSequence,A=t.DERSet,m=t.DERTaggedObject,y=t.ASN1Util.newObject,b=Object.keys(V);if(1!=b.length)throw"key of param shall be only one.";var T=b[0];if(-1==":bool:int:bitstr:octstr:null:oid:enum:utf8str:numstr:prnstr:telstr:ia5str:utctime:gentime:seq:set:tag:".indexOf(":"+T+":"))throw"undefined key: "+T;if("bool"==T)return new e(V[T]);if("int"==T)return new i(V[T]);if("bitstr"==T)return new r(V[T]);if("octstr"==T)return new n(V[T]);if("null"==T)return new s(V[T]);if("oid"==T)return new o(V[T]);if("enum"==T)return new h(V[T]);if("utf8str"==T)return new a(V[T]);if("numstr"==T)return new u(V[T]);if("prnstr"==T)return new c(V[T]);if("telstr"==T)return new f(V[T]);if("ia5str"==T)return new l(V[T]);if("utctime"==T)return new p(V[T]);if("gentime"==T)return new g(V[T]);if("seq"==T){for(var S,N=V[T],v=[],I=0;I<N.length;I++)S=y(N[I]),v.push(S);return new d({array:v})}if("set"==T){for(N=V[T],v=[],I=0;I<N.length;I++)S=y(N[I]),v.push(S);return new A({array:v})}if("tag"==T){var P=V[T];if("[object Array]"===Object.prototype.toString.call(P)&&3==P.length){var R=y(P[2]);return new m({tag:P[0],explicit:P[1],obj:R})}var B={};if(void 0!==P.explicit&&(B.explicit=P.explicit),void 0!==P.tag&&(B.tag=P.tag),void 0===P.obj)throw"obj shall be specified for 'tag'.";return B.obj=y(P.obj),new m(B)}},this.jsonToASN1HEX=function(e){return this.newObject(e).getEncodedHex()}},W.asn1.ASN1Util.oidHexToInt=function(o){for(var t,a="",p=parseInt(o.substr(0,2),16),i=(a=ee(p/40)+"."+p%40,""),d=2;d<o.length;d+=2)t=("00000000"+parseInt(o.substr(d,2),16).toString(2)).slice(-8),i+=t.substr(1,7),"0"==t.substr(0,1)&&(a=a+"."+new R(i,2).toString(10),i="");return a},W.asn1.ASN1Util.oidIntToHex=function(a){var t=function n(r){var n=r.toString(16);return 1==n.length&&(n="0"+n),n},e=function e(a){var e="",p=new R(a,10).toString(2),d=7-p.length%7;7==d&&(d=0);for(var g="",l=0;l<d;l++)g+="0";for(p=g+p,l=0;l<p.length-1;l+=7){var u=p.substr(l,7);l!=p.length-7&&(u="1"+u),e+=t(parseInt(u,2))}return e};if(!a.match(/^[0-9.]+$/))throw"malformed oid string: "+a;var i="",p=a.split("."),n=40*parseInt(p[0])+parseInt(p[1]);i+=t(n),p.splice(0,2);for(var s=0;s<p.length;s++)i+=e(p[s]);return i},W.asn1.ASN1Object=function(){this.getLengthHexFromValue=function(){if(void 0===this.hV||null==this.hV)throw"this.hV is null or undefined.";if(1==this.hV.length%2)throw"value hex must be even length: n=0,v="+this.hV;var n=this.hV.length/2,t=n.toString(16);if(1==t.length%2&&(t="0"+t),128>n)return t;var r=t.length/2;if(15<r)throw"ASN.1 length too long to represent by 8x: n = "+n.toString(16);return(128+r).toString(16)+t},this.getEncodedHex=function(){return(null==this.hTLV||this.isModified)&&(this.hV=this.getFreshValueHex(),this.hL=this.getLengthHexFromValue(),this.hTLV=this.hT+this.hL+this.hV,this.isModified=!1),this.hTLV},this.getValueHex=function(){return this.getEncodedHex(),this.hV},this.getFreshValueHex=function(){return""}},W.asn1.DERAbstractString=function(e){W.asn1.DERAbstractString.superclass.constructor.call(this),this.getString=function(){return this.s},this.setString=function(e){this.hTLV=null,this.isModified=!0,this.s=e,this.hV=stohex(this.s)},this.setStringHex=function(e){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=e},this.getFreshValueHex=function(){return this.hV},void 0!==e&&("string"==typeof e?this.setString(e):void 0===e.str?void 0!==e.hex&&this.setStringHex(e.hex):this.setString(e.str))},Q.lang.extend(W.asn1.DERAbstractString,W.asn1.ASN1Object),W.asn1.DERAbstractTime=function(){W.asn1.DERAbstractTime.superclass.constructor.call(this),this.localDateToUTC=function(e){return utc=e.getTime()+6e4*e.getTimezoneOffset(),new Date(utc)},this.formatDate=function(p,t,e){var i=this.zeroPadding,r=this.localDateToUTC(p),n=r.getFullYear()+"";"utc"==t&&(n=n.substr(2,2));var d=n+i(r.getMonth()+1+"",2)+i(r.getDate()+"",2)+i(r.getHours()+"",2)+i(r.getMinutes()+"",2)+i(r.getSeconds()+"",2);if(!0===e){var g=r.getMilliseconds();if(0!=g){var l=i(g+"",3);d=d+"."+(l=l.replace(/[0]+$/,""))}}return d+"Z"},this.zeroPadding=function(n,t){return n.length>=t?n:Array(t-n.length+1).join("0")+n},this.getString=function(){return this.s},this.setString=function(e){this.hTLV=null,this.isModified=!0,this.s=e,this.hV=stohex(e)},this.setByDateValue=function(a,t,e,i,r,n){var s=new Date(Date.UTC(a,t-1,e,i,r,n,0));this.setByDate(s)},this.getFreshValueHex=function(){return this.hV}},Q.lang.extend(W.asn1.DERAbstractTime,W.asn1.ASN1Object),W.asn1.DERAbstractStructured=function(e){W.asn1.DERAbstractString.superclass.constructor.call(this),this.setByASN1ObjectArray=function(e){this.hTLV=null,this.isModified=!0,this.asn1Array=e},this.appendASN1Object=function(e){this.hTLV=null,this.isModified=!0,this.asn1Array.push(e)},this.asn1Array=[],void 0!==e&&void 0!==e.array&&(this.asn1Array=e.array)},Q.lang.extend(W.asn1.DERAbstractStructured,W.asn1.ASN1Object),W.asn1.DERBoolean=function(){W.asn1.DERBoolean.superclass.constructor.call(this),this.hT="01",this.hTLV="0101ff"},Q.lang.extend(W.asn1.DERBoolean,W.asn1.ASN1Object),W.asn1.DERInteger=function(e){W.asn1.DERInteger.superclass.constructor.call(this),this.hT="02",this.setByBigInteger=function(e){this.hTLV=null,this.isModified=!0,this.hV=W.asn1.ASN1Util.bigIntToMinTwosComplementsHex(e)},this.setByInteger=function(n){var t=new R(n+"",10);this.setByBigInteger(t)},this.setValueHex=function(e){this.hV=e},this.getFreshValueHex=function(){return this.hV},void 0!==e&&(void 0===e.bigint?void 0===e.int?"number"==typeof e?this.setByInteger(e):void 0!==e.hex&&this.setValueHex(e.hex):this.setByInteger(e.int):this.setByBigInteger(e.bigint))},Q.lang.extend(W.asn1.DERInteger,W.asn1.ASN1Object),W.asn1.DERBitString=function(n){if(void 0!==n&&void 0!==n.obj){var t=W.asn1.ASN1Util.newObject(n.obj);n.hex="00"+t.getEncodedHex()}W.asn1.DERBitString.superclass.constructor.call(this),this.hT="03",this.setHexValueIncludingUnusedBits=function(e){this.hTLV=null,this.isModified=!0,this.hV=e},this.setUnusedBitsAndHexValue=function(n,t){if(0>n||7<n)throw"unused bits shall be from 0 to 7: u = "+n;this.hTLV=null,this.isModified=!0,this.hV="0"+n+t},this.setByBinaryString=function(o){var a=8-(o=o.replace(/0+$/,"")).length%8;8==a&&(a=0);for(var p=0;p<=a;p++)o+="0";var d="";for(p=0;p<o.length-1;p+=8){var g=o.substr(p,8),n=parseInt(g,2).toString(16);1==n.length&&(n="0"+n),d+=n}this.hTLV=null,this.isModified=!0,this.hV="0"+a+d},this.setByBooleanArray=function(n){for(var t="",r=0;r<n.length;r++)t+=1==n[r]?"1":"0";this.setByBinaryString(t)},this.newFalseArray=function(n){for(var t=Array(n),e=0;e<n;e++)t[e]=!1;return t},this.getFreshValueHex=function(){return this.hV},void 0!==n&&("string"==typeof n&&n.toLowerCase().match(/^[0-9a-f]+$/)?this.setHexValueIncludingUnusedBits(n):void 0===n.hex?void 0===n.bin?void 0!==n.array&&this.setByBooleanArray(n.array):this.setByBinaryString(n.bin):this.setHexValueIncludingUnusedBits(n.hex))},Q.lang.extend(W.asn1.DERBitString,W.asn1.ASN1Object),W.asn1.DEROctetString=function(n){if(void 0!==n&&void 0!==n.obj){var t=W.asn1.ASN1Util.newObject(n.obj);n.hex=t.getEncodedHex()}W.asn1.DEROctetString.superclass.constructor.call(this,n),this.hT="04"},Q.lang.extend(W.asn1.DEROctetString,W.asn1.DERAbstractString),W.asn1.DERNull=function(){W.asn1.DERNull.superclass.constructor.call(this),this.hT="05",this.hTLV="0500"},Q.lang.extend(W.asn1.DERNull,W.asn1.ASN1Object),W.asn1.DERObjectIdentifier=function(n){var a=function n(r){var n=r.toString(16);return 1==n.length&&(n="0"+n),n},e=function e(p){var e="",t=new R(p,10).toString(2),d=7-t.length%7;7==d&&(d=0);for(var g="",l=0;l<d;l++)g+="0";for(t=g+t,l=0;l<t.length-1;l+=7){var u=t.substr(l,7);l!=t.length-7&&(u="1"+u),e+=a(parseInt(u,2))}return e};W.asn1.DERObjectIdentifier.superclass.constructor.call(this),this.hT="06",this.setValueHex=function(e){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=e},this.setValueOidString=function(i){if(!i.match(/^[0-9.]+$/))throw"malformed oid string: "+i;var t="",p=i.split("."),n=40*parseInt(p[0])+parseInt(p[1]);t+=a(n),p.splice(0,2);for(var s=0;s<p.length;s++)t+=e(p[s]);this.hTLV=null,this.isModified=!0,this.s=null,this.hV=t},this.setValueName=function(n){var t=W.asn1.x509.OID.name2oid(n);if(""===t)throw"DERObjectIdentifier oidName undefined: "+n;this.setValueOidString(t)},this.getFreshValueHex=function(){return this.hV},void 0!==n&&("string"==typeof n?n.match(/^[0-2].[0-9.]+$/)?this.setValueOidString(n):this.setValueName(n):void 0===n.oid?void 0===n.hex?void 0!==n.name&&this.setValueName(n.name):this.setValueHex(n.hex):this.setValueOidString(n.oid))},Q.lang.extend(W.asn1.DERObjectIdentifier,W.asn1.ASN1Object),W.asn1.DEREnumerated=function(e){W.asn1.DEREnumerated.superclass.constructor.call(this),this.hT="0a",this.setByBigInteger=function(e){this.hTLV=null,this.isModified=!0,this.hV=W.asn1.ASN1Util.bigIntToMinTwosComplementsHex(e)},this.setByInteger=function(n){var t=new R(n+"",10);this.setByBigInteger(t)},this.setValueHex=function(e){this.hV=e},this.getFreshValueHex=function(){return this.hV},void 0!==e&&(void 0===e.int?"number"==typeof e?this.setByInteger(e):void 0!==e.hex&&this.setValueHex(e.hex):this.setByInteger(e.int))},Q.lang.extend(W.asn1.DEREnumerated,W.asn1.ASN1Object),W.asn1.DERUTF8String=function(e){W.asn1.DERUTF8String.superclass.constructor.call(this,e),this.hT="0c"},Q.lang.extend(W.asn1.DERUTF8String,W.asn1.DERAbstractString),W.asn1.DERNumericString=function(e){W.asn1.DERNumericString.superclass.constructor.call(this,e),this.hT="12"},Q.lang.extend(W.asn1.DERNumericString,W.asn1.DERAbstractString),W.asn1.DERPrintableString=function(e){W.asn1.DERPrintableString.superclass.constructor.call(this,e),this.hT="13"},Q.lang.extend(W.asn1.DERPrintableString,W.asn1.DERAbstractString),W.asn1.DERTeletexString=function(e){W.asn1.DERTeletexString.superclass.constructor.call(this,e),this.hT="14"},Q.lang.extend(W.asn1.DERTeletexString,W.asn1.DERAbstractString),W.asn1.DERIA5String=function(e){W.asn1.DERIA5String.superclass.constructor.call(this,e),this.hT="16"},Q.lang.extend(W.asn1.DERIA5String,W.asn1.DERAbstractString),W.asn1.DERUTCTime=function(e){W.asn1.DERUTCTime.superclass.constructor.call(this,e),this.hT="17",this.setByDate=function(e){this.hTLV=null,this.isModified=!0,this.date=e,this.s=this.formatDate(this.date,"utc"),this.hV=stohex(this.s)},this.getFreshValueHex=function(){return void 0===this.date&&void 0===this.s&&(this.date=new Date,this.s=this.formatDate(this.date,"utc"),this.hV=stohex(this.s)),this.hV},void 0!==e&&(void 0===e.str?"string"==typeof e&&e.match(/^[0-9]{12}Z$/)?this.setString(e):void 0===e.hex?void 0!==e.date&&this.setByDate(e.date):this.setStringHex(e.hex):this.setString(e.str))},Q.lang.extend(W.asn1.DERUTCTime,W.asn1.DERAbstractTime),W.asn1.DERGeneralizedTime=function(e){W.asn1.DERGeneralizedTime.superclass.constructor.call(this,e),this.hT="18",this.withMillis=!1,this.setByDate=function(e){this.hTLV=null,this.isModified=!0,this.date=e,this.s=this.formatDate(this.date,"gen",this.withMillis),this.hV=stohex(this.s)},this.getFreshValueHex=function(){return void 0===this.date&&void 0===this.s&&(this.date=new Date,this.s=this.formatDate(this.date,"gen",this.withMillis),this.hV=stohex(this.s)),this.hV},void 0!==e&&(void 0===e.str?"string"==typeof e&&e.match(/^[0-9]{14}Z$/)?this.setString(e):void 0===e.hex?void 0!==e.date&&this.setByDate(e.date):this.setStringHex(e.hex):this.setString(e.str),!0===e.millis&&(this.withMillis=!0))},Q.lang.extend(W.asn1.DERGeneralizedTime,W.asn1.DERAbstractTime),W.asn1.DERSequence=function(e){W.asn1.DERSequence.superclass.constructor.call(this,e),this.hT="30",this.getFreshValueHex=function(){for(var n="",r=0;r<this.asn1Array.length;r++)n+=this.asn1Array[r].getEncodedHex();return this.hV=n,this.hV}},Q.lang.extend(W.asn1.DERSequence,W.asn1.DERAbstractStructured),W.asn1.DERSet=function(e){W.asn1.DERSet.superclass.constructor.call(this,e),this.hT="31",this.sortFlag=!0,this.getFreshValueHex=function(){for(var n,r=[],t=0;t<this.asn1Array.length;t++)n=this.asn1Array[t],r.push(n.getEncodedHex());return 1==this.sortFlag&&r.sort(),this.hV=r.join(""),this.hV},void 0!==e&&void 0!==e.sortflag&&0==e.sortflag&&(this.sortFlag=!1)},Q.lang.extend(W.asn1.DERSet,W.asn1.DERAbstractStructured),W.asn1.DERTaggedObject=function(e){W.asn1.DERTaggedObject.superclass.constructor.call(this),this.hT="a0",this.hV="",this.isExplicit=!0,this.asn1Object=null,this.setASN1Object=function(n,t,e){this.hT=t,this.isExplicit=n,this.asn1Object=e,this.isExplicit?(this.hV=this.asn1Object.getEncodedHex(),this.hTLV=null,this.isModified=!0):(this.hV=null,this.hTLV=e.getEncodedHex(),this.hTLV=this.hTLV.replace(/^../,t),this.isModified=!1)},this.getFreshValueHex=function(){return this.hV},void 0!==e&&(void 0!==e.tag&&(this.hT=e.tag),void 0!==e.explicit&&(this.isExplicit=e.explicit),void 0!==e.obj&&(this.asn1Object=e.obj,this.setASN1Object(this.isExplicit,this.hT,this.asn1Object)))},Q.lang.extend(W.asn1.DERTaggedObject,W.asn1.ASN1Object);var le,ue=(le=function(n,t){return(le=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(n[e]=t[e])})(n,t)},function(n,t){function e(){this.constructor=n}if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+(t+"")+" is not a constructor or null");le(n,t),n.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)}),ce=function(n){function o(e){var t=n.call(this)||this;return e&&("string"==typeof e?t.parseKey(e):(o.hasPrivateKeyProperty(e)||o.hasPublicKeyProperty(e))&&t.parsePropertiesFrom(e)),t}return ue(o,n),o.prototype.parseKey=function(p){try{var t=0,d=0,g=/^\s*(?:[0-9A-Fa-f][0-9A-Fa-f]\s*)+$/.test(p)?function(r){var t;if(void 0===F){var a="0123456789ABCDEF";for(F={},t=0;16>t;++t)F[a.charAt(t)]=t;for(a=a.toLowerCase(),t=10;16>t;++t)F[a.charAt(t)]=t;for(t=0;t<" \f\n\r\t\xA0\u2028\u2029".length;++t)F[" \f\n\r\t\xA0\u2028\u2029".charAt(t)]=-1}var p=[],n=0,d=0;for(t=0;t<r.length;++t){var g=r.charAt(t);if("="==g)break;if(-1!=(g=F[g])){if(void 0===g)throw new Error("Illegal character at offset "+t);n|=g,2<=++d?(p[p.length]=n,n=0,d=0):n<<=4}}if(d)throw new Error("Hex encoding incomplete: 4 bits missing");return p}(p):re.unarmor(p),r=E.decode(g);if(3===r.sub.length&&(r=r.sub[2].sub[0]),9===r.sub.length){t=r.sub[1].getHexStringValue(),this.n=N(t,16),d=r.sub[2].getHexStringValue(),this.e=parseInt(d,16);var c=r.sub[3].getHexStringValue();this.d=N(c,16);var s=r.sub[4].getHexStringValue();this.p=N(s,16);var o=r.sub[5].getHexStringValue();this.q=N(o,16);var h=r.sub[6].getHexStringValue();this.dmp1=N(h,16);var a=r.sub[7].getHexStringValue();this.dmq1=N(a,16);var u=r.sub[8].getHexStringValue();this.coeff=N(u,16)}else{if(2!==r.sub.length)return!1;var m=r.sub[1].sub[0];t=m.sub[0].getHexStringValue(),this.n=N(t,16),d=m.sub[1].getHexStringValue(),this.e=parseInt(d,16)}return!0}catch(e){return!1}},o.prototype.getPrivateBaseKey=function(){var e={array:[new W.asn1.DERInteger({int:0}),new W.asn1.DERInteger({bigint:this.n}),new W.asn1.DERInteger({int:this.e}),new W.asn1.DERInteger({bigint:this.d}),new W.asn1.DERInteger({bigint:this.p}),new W.asn1.DERInteger({bigint:this.q}),new W.asn1.DERInteger({bigint:this.dmp1}),new W.asn1.DERInteger({bigint:this.dmq1}),new W.asn1.DERInteger({bigint:this.coeff})]};return new W.asn1.DERSequence(e).getEncodedHex()},o.prototype.getPrivateBaseKeyB64=function(){return u(this.getPrivateBaseKey())},o.prototype.getPublicBaseKey=function(){var n=new W.asn1.DERSequence({array:[new W.asn1.DERObjectIdentifier({oid:"1.2.840.113549.1.1.1"}),new W.asn1.DERNull]}),t=new W.asn1.DERSequence({array:[new W.asn1.DERInteger({bigint:this.n}),new W.asn1.DERInteger({int:this.e})]}),e=new W.asn1.DERBitString({hex:"00"+t.getEncodedHex()});return new W.asn1.DERSequence({array:[n,e]}).getEncodedHex()},o.prototype.getPublicBaseKeyB64=function(){return u(this.getPublicBaseKey())},o.wordwrap=function(n,t){if(!n)return n;var r="(.{1,"+(t=t||64)+"})( +|$\n?)|(.{1,"+t+"})";return n.match(RegExp(r,"g")).join("\n")},o.prototype.getPrivateKey=function(){var e="-----BEGIN RSA PRIVATE KEY-----\n";return(e+=o.wordwrap(this.getPrivateBaseKeyB64())+"\n")+"-----END RSA PRIVATE KEY-----"},o.prototype.getPublicKey=function(){var e="-----BEGIN PUBLIC KEY-----\n";return(e+=o.wordwrap(this.getPublicBaseKeyB64())+"\n")+"-----END PUBLIC KEY-----"},o.hasPublicKeyProperty=function(e){return(e=e||{}).hasOwnProperty("n")&&e.hasOwnProperty("e")},o.hasPrivateKeyProperty=function(e){return(e=e||{}).hasOwnProperty("n")&&e.hasOwnProperty("e")&&e.hasOwnProperty("d")&&e.hasOwnProperty("p")&&e.hasOwnProperty("q")&&e.hasOwnProperty("dmp1")&&e.hasOwnProperty("dmq1")&&e.hasOwnProperty("coeff")},o.prototype.parsePropertiesFrom=function(e){this.n=e.n,this.e=e.e,e.hasOwnProperty("d")&&(this.d=e.d,this.p=e.p,this.q=e.q,this.dmp1=e.dmp1,this.dmq1=e.dmq1,this.coeff=e.coeff)},o}(J),he=function(){function e(e){void 0===e&&(e={}),e=e||{},this.default_key_size=e.default_key_size?parseInt(e.default_key_size,10):1024,this.default_public_exponent=e.default_public_exponent||"010001",this.log=e.log||!1,this.key=null}return e.prototype.setKey=function(e){this.log&&this.key&&console.warn("A key was already set, overriding existing."),this.key=new ce(e)},e.prototype.setPrivateKey=function(e){this.setKey(e)},e.prototype.setPublicKey=function(e){this.setKey(e)},e.prototype.decrypt=function(e){try{return this.getKey().decrypt(l(e))}catch(e){return!1}},e.prototype.encrypt=function(e){try{return u(this.getKey().encrypt(e))}catch(e){return!1}},e.prototype.sign=function(n,t,e){try{return u(this.getKey().sign(n,t,e))}catch(e){return!1}},e.prototype.verify=function(n,t,e){try{return this.getKey().verify(n,l(t),e)}catch(e){return!1}},e.prototype.getKey=function(e){if(!this.key){if(this.key=new ce,e&&"[object Function]"==={}.toString.call(e))return void this.key.generateAsync(this.default_key_size,this.default_public_exponent,e);this.key.generate(this.default_key_size,this.default_public_exponent)}return this.key},e.prototype.getPrivateKey=function(){return this.getKey().getPrivateKey()},e.prototype.getPrivateKeyB64=function(){return this.getKey().getPrivateBaseKeyB64()},e.prototype.getPublicKey=function(){return this.getKey().getPublicKey()},e.prototype.getPublicKeyB64=function(){return this.getKey().getPublicBaseKeyB64()},e.version="3.2.1",e}()}],o={d:function(e,t){for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o:function(n,t){return Object.prototype.hasOwnProperty.call(n,t)}},e={};return n[1](0,e,o),e.default}()});